(this["webpackJsonpsearch-sengrid-template-app"]=this["webpackJsonpsearch-sengrid-template-app"]||[]).push([[0],{131:function(e,t,n){},432:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(14),c=n(26),i=(n(128),n(129),n(130),n(131),n(50)),s=n(12),o=n.n(s),u=n(22),p=n(116),l=n(117),d=n(121),h=n(120),j=n(8),f=n(27),m=n(7),b=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).onConfigure=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.sdk.app.getCurrentState();case 2:return t=e.sent,e.abrupt("return",{parameters:a.state.parameters,targetState:t});case 4:case"end":return e.stop()}}),e)}))),a.handleApiKeyChange=function(e){var t=a.state.parameters;console.log(e.target.value),a.setState({parameters:Object(i.a)(Object(i.a)({},t),{},{apikey:e.target.value})})},a.state={parameters:{apikey:""}},e.sdk.app.onConfigure((function(){return a.onConfigure()})),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t,n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.sdk.app.getParameters();case 2:t=e.sent,this.setState(t?{parameters:t}:this.state,(function(){n.props.sdk.app.setReady()}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(m.jsx)(j.Workbench,{className:Object(f.a)({margin:"80px"}),children:Object(m.jsx)(j.Form,{className:Object(f.a)({width:"100%"}),children:Object(m.jsxs)(j.FieldGroup,{className:Object(f.a)({width:"50%"}),children:[Object(m.jsx)(j.Heading,{children:"App Config"}),Object(m.jsx)(j.Paragraph,{children:"Welcome to your contentful app. This is your config page."}),Object(m.jsx)(j.TextField,{required:!0,name:"apikey",id:"apikey",labelText:"Sendgrind API Key",value:this.state.parameters.apikey,onChange:this.handleApiKeyChange,helpText:"Provide Sendgrid API Key"})]})})})}}]),n}(a.Component),O=n(28),g=n(49),x=n.n(g),v=n(119),k=Object(v.setupCache)({maxAge:6e4}),y=x.a.create({adapter:k.adapter}),C=function(e){var t,n=e.sdk,r=n.parameters.installation.apikey,c=Object(a.useState)({id:n.field.getValue(),name:""}),i=Object(O.a)(c,2),s=i[0],p=i[1],l=Object(a.useState)([]),d=Object(O.a)(l,2),h=d[0],f=d[1],b=Object(a.useState)(h),g=Object(O.a)(b,2),x=g[0],v=g[1];Object(a.useEffect)((function(){(function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return e.next=3,y({method:"GET",url:"https://api.sendgrid.com/v3/templates?page_size=200&generations=dynamic",headers:{"content-type":"application/octet-stream",authorization:"bearer ".concat(r)},params:{language_code:"en"}}).then((function(e){return e.data.result.map((function(e){return{id:e.id,name:e.name}}))})).catch((function(e){return[]}));case 3:t=e.sent,f(t),v(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[r]);var k=Object(a.useCallback)((function(e){var t=e?h.filter((function(t){var n=e.split(" ").filter((function(e){return e})),a=new RegExp(n.join(".*"),"ig");return(t.name.match(a)||[]).length})):h;v(t)}),[v,h]);return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(j.Autocomplete,{maxHeight:90,onQueryChange:k,items:x,onChange:function(e){var t=e.id,a=e.name;n.field.setValue(t),p({id:t,name:a})},isLoading:0===h.length,children:function(e){return e.map((function(e){return Object(m.jsx)("span",{children:e.name},e.id)}))}}),Object(m.jsxs)(j.Note,{noteType:"positive",children:[Object(m.jsx)(j.HelpText,{children:null===(t=h.filter((function(e){return e.id===n.field.getValue()}))[0])||void 0===t?void 0:t.name}),Object(m.jsx)(j.Heading,{children:s.id})]})]})};Object(c.init)((function(e){var t=document.getElementById("root");[{location:c.locations.LOCATION_APP_CONFIG,component:Object(m.jsx)(b,{sdk:e})},{location:c.locations.LOCATION_ENTRY_FIELD,component:Object(m.jsx)(C,{sdk:e})}].forEach((function(n){e.location.is(n.location)&&Object(r.render)(n.component,t)}))}))}},[[432,1,2]]]);
//# sourceMappingURL=main.8012225d.chunk.js.map